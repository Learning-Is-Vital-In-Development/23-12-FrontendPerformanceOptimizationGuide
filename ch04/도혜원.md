# 4. 이미지 갤러리 최적화

# 캐시 최적화

> **캐시란?**
> 자주 사용하는 데이터나 값을 미리 복사해 둔 임시 저장공간 또는 저장하는 동작.
> 최초에만 다운로드하여 캐시에 저장해두고 그 이후 요청시에는 저장해둔 파일을 사용한다.

## 캐시의 종류

- 메모리 캐시 : 메모리에 저장하는 방식. 메모리는 RAM
- 디스크 캐시 : 파일 형태로 디스크에 저장하는 방식

- 어떤 캐시를 사용할지는 직접 제어할 수 없다. 브라우저가 사용빈도나 파일크기에 따라 특정 알고리즘에 의해 처리한다.

## Cache-control

- 리소스의 응답 헤더에 설정되는 헤더
- 브라우저는 서버에서 이 헤더를 통해 캐시를 어떻게, 얼마나 적용해야하는지 판단한다.

- no-cache : 캐시를 사용하기 전 서버에 검사 후 사용
- no-store : 캐시 사용 안 함
- public : 모든 환경에서 캐시 사용 가능
- private : 브라우저 환경에서만 캐시 사용, 외부 캐시 서버에서는 사용 불가
- max-age : 캐시의 유효 시간

<aside>
👉🏻 **캐시된 리소스와 서버의 최신 리소스가 같은지 다른지 어떻게 체크할까?**
서버에는 캐시된 리소스의 응답헤더에 있는 Etag 값과 서버에 있는 최신 리소스의 Etag 값을 비교하여 캐시된 리소스가 최신인지 아닌지 판단한다.

</aside>

# 불필요한 CSS 제거

## PurgeCSS

- 사용하지 않는 CSS 코드를 제거
- 파일에 들어있는 모든 키워드를 추출하여 해당 키워드를 이름으로 갖는 CSS 클래스만 보존하고 나머지 매칭되지않은 클래스는 모두 지우는방식으로 CSS 파일을 최적화한다.

# 이미지 지연로딩

- 라이브러리를 사용해서 구현

# 레이아웃 이동 피하기

- 화면상의 요소 변화로 레이아웃이 갑자기 밀리는 현상
- ux에 좋지않은 영향을 준다.
- lighthouse의 cls 지표를 확인해보기!
- css : aspect-ratio 속성을 사용해 이미지의 사이즈를 기정의할수있다!!!!

- layout shift 수식
  [https://web.dev/i18n/ko/cls/](https://web.dev/i18n/ko/cls/)

<aside>
❓ Layout Shift Score = Impact Fraction * Distance Fraction

</aside>

# 리덕스 렌더링 최적화

- useSelect로 관찰하고있는 값이 실제로 변경되었을때 리렌더가 발생하는 방식으로 처리할 수 있다.

# 병목 코드 최적화

- 메모이제이션

<aside>
❓ useCallback과 useMemo, React.memo

</aside>
